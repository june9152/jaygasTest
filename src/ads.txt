여러 ADS1220 IC를 CS 핀을 변경해가며 번갈아 가며 읽을 때 값이 다르게 나오는 문제는 SPI 통신 버스 관리 또는 선택되지 않은(unselected) IC와 선택된 IC 간의 예상치 못한 상호 작용과 관련이 있을 수 있습니다. 다음은 소스에 기반한 몇 가지 가능한 원인과 해결책입니다.
• DOUT/DRDY 핀 관리 (특히 DOUT/DRDY를 데이터 레디 표시로 사용할 경우):
    ◦ 여러 ADS1220 장치를 단일 SPI 버스에 연결할 때, 각 장치에 전용 칩 셀렉트(CS) 라인을 사용하는 것이 안전하다고 명시되어 있습니다.
    ◦ CS 핀이 하이(high)로 전환되면, DOUT/DRDY 핀은 하이 임피던스 상태가 됩니다. 따라서 CS가 하이인 동안에는 DOUT/DRDY 핀을 통해 새로운 데이터 가용성을 알 수 없습니다.
    ◦ 새로운 변환 결과가 준비되었는지 확인하기 위해 마이크로컨트롤러가 주기적으로 CS를 낮춰 DOUT/DRDY 핀의 상태를 폴링할 수 있습니다. 이 절차를 위해서는 각 변환 결과를 읽은 후 CS를 하이로 만들기 전에 DOUT/DRDY가 하이 상태가 되도록 해야 합니다. 이를 위해 데이터 읽기 작업 후 DIN을 로우로 유지하면서 8개의 추가 SCLK를 보내는 것이 권장됩니다. 이렇게 하면 DOUT/DRDY가 하이 상태로 읽힙니다.
    ◦ 이 절차가 제대로 이행되지 않으면, 선택이 해제된 IC의 DOUT/DRDY 핀이 하이 임피던스 상태로 빠르게 진입하지 못하거나, 다음 선택되는 IC의 통신에 영향을 줄 수 있는 잔류 전압을 가질 수 있습니다.
• 사용하지 않는 아날로그/디지털 입력 및 출력 관리:
    ◦ 아날로그 입력에서 누설 전류를 최소화하려면, 사용하지 않는 아날로그 및 레퍼런스 입력은 플로팅 상태로 두거나, 미드-서플라이(mid-supply) 또는 AVDD에 연결하는 것이 좋습니다.
    ◦ 사용하지 않는 디지털 입력은 플로팅 상태로 두지 말아야 합니다. 과도한 전원 공급 장치 누설 전류가 발생할 수 있습니다. 사용하지 않는 모든 디지털 입력은 전원 차단 모드에서도 DVDD 또는 DGND와 같은 적절한 레벨에 연결해야 합니다.
    ◦ 선택되지 않은 IC의 입력/출력 핀이 명시된 지침대로 처리되지 않으면, 이는 다른 IC의 아날로그 측정에 간섭을 일으키거나, 시스템의 전반적인 노이즈 플로어를 증가시켜 값의 차이를 유발할 수 있습니다.
• 전원 공급 장치 디커플링 및 노이즈:
    ◦ 최적의 성능을 위해서는 양질의 전원 공급 장치 디커플링이 중요합니다. AVDD, AVSS(양극 전원 사용 시), DVDD는 최소 0.1µF 커패시터로 디커플링되어야 합니다. 바이패스 커패시터는 장치 전원 핀에 가능한 한 가깝게 배치하고 낮은 임피던스 연결을 사용해야 합니다.
    ◦ 전압 레퍼런스의 모든 노이즈와 드리프트는 변환 결과에 반영됩니다. 전원 공급 장치 노이즈가 선택되는 IC에 따라 다르게 영향을 미치거나, IC 전환 시 일시적인 전압 강하 또는 노이즈가 발생하면 측정값에 영향을 줄 수 있습니다.
• 오프셋 캘리브레이션:
    ◦ 소스에서는 측정을 수행하기 전 또는 PGA 게인을 변경할 때 오프셋 캘리브레이션을 실행하는 것을 권장합니다.
    ◦ 장치의 내부 오프셋은 입력이 미드-서플라이에 단락되었을 때 측정하여 마이크로컨트롤러에 저장할 수 있습니다. 이후 센서 신호를 측정할 때 저장된 오프셋 값을 각 장치 판독값에서 빼서 오프셋이 보정된 결과를 얻을 수 있습니다.
    ◦ 만약 "값이 다르다"는 것이 일관된 오프셋 차이를 의미한다면, 각 IC에 대해 또는 전환 시 발생하는 오프셋을 캘리브레이션하여 해결할 수 있습니다.
• SPI 신호 무결성:
    ◦ 마이크로컨트롤러 SPI 주변 장치는 ADS1220과 통신할 수 있으며, SPI 모드 1(CPOL = 0, CPHA = 1)로 작동합니다.
    ◦ 모든 디지털 입력 및 출력 핀(CS, SCLK, DIN, DOUT/DRDY, DRDY)에 47Ω 저항을 직렬로 배치하는 것을 권장합니다. 이는 날카로운 전환을 부드럽게 하고 오버슈트를 억제하며 일부 과전압 보호 기능을 제공합니다. 이는 신호 무결성 문제를 줄이는 데 도움이 됩니다.
ADS1220은 여러 센서 신호를 측정하기 위한 많은 통합 기능을 제공하는 정밀 24비트 ADC이며, 각 장치에 전용 CS 라인을 사용하여 여러 장치를 SPI 버스에 안전하게 연결할 수 있습니다. 따라서 문제의 원인은 대부분 하드웨어 레이아웃, SPI 통신 프로토콜 구현 또는 선택되지 않은 장치 처리와 관련이 있을 가능성이 큽니다. 위에 언급된 사항들을 면밀히 검토하고 적용해 보시기 바랍니다.